function t(t){if(!t||0===t.length)return null;const e=document.createElement("ul");return e.className="subtask-list",t.forEach((t=>{const n=document.createElement("li");n.className="subtask-item";const a=document.createElement("span");a.className="subtask-item-main";const s=document.createElement("img");s.src=t.issueTypeIconUrl,s.alt=t.issueType,s.className="subtask-issuetype-icon",a.appendChild(s);const l=document.createElement("a");l.className="subtask-title-link",l.textContent=t.title,l.dataset.fullTitle=t.title,l.href=t.url,l.target="_blank",l.rel="noopener noreferrer",l.addEventListener("click",(t=>{t.stopPropagation()})),a.appendChild(l),n.appendChild(a);const o=document.createElement("span");o.className="subtask-item-details";const i=document.createElement("span");if(i.className="subtask-status",i.textContent=t.status,o.appendChild(i),t.avatarUrl){const e=document.createElement("img");e.src=t.avatarUrl,e.alt=t.assigneeName,e.className="subtask-avatar",o.appendChild(e)}n.appendChild(o),e.appendChild(n)})),e}async function e(e){const n=e||document.querySelectorAll('div[data-testid="platform-board-kit.ui.card.card"]');for(const e of n){if("true"===e.dataset.subtasksProcessed)continue;const n='div[data-testid="platform-card.common.ui.custom-fields.card-custom-field.html-card-custom-field-content.html-field"][data-issuefieldid="subtasks"]',a=e.querySelector(n);if(!a){e.dataset.subtasksProcessed="true";continue}const s=(a.textContent.match(/[A-ZÁÉÍÓÚÑÜ]+-[0-9]+/gi)||[]).map((t=>t.toUpperCase()));if(s.length>0){const e=s.map((t=>new Promise((e=>{chrome.runtime.sendMessage({type:"GET_SUBTASK_DETAILS",issueKey:t},(t=>{chrome.runtime.lastError?e(null):e(t&&t.success?t.data:null)}))})))),n=(await Promise.all(e)).filter(Boolean);if(n.length>0){const e=t(n);e&&(a.innerHTML="",a.appendChild(e))}}e.dataset.subtasksProcessed="true"}}const n='[data-testid="platform-board-kit.common.ui.column-header.header.column-header-container"]',a='[data-testid="platform-board-kit.common.ui.column-header.editable-title.column-title.column-title"]',s='[data-testid="platform-board-kit.ui.column.draggable-column.styled-wrapper"]',l='[data-testid="platform-board-kit.ui.swimlane.swimlane-columns"]';let o=!1,i=null;function c(){if(!i){const t=document.querySelector('[data-testid="platform-board-kit.common.ui.column-header.editable-title.column-title.column-name"]');i=t?t.textContent.trim():"Columna"}const t=Array.from(document.querySelectorAll(l)).map((t=>t.querySelector(s))).filter(Boolean);if(0===t.length)return;t.forEach((t=>{let e=t.querySelector(".vertical-column-title");e||(e=document.createElement("div"),e.className="vertical-column-title",t.appendChild(e)),!e.textContent&&i&&(e.textContent=i,e.title=i),t.classList.toggle("is-collapsed",o);const n=t.firstChild?.firstChild;n&&n.classList.toggle("hide",o),t.dataset.clickListenerAdded||(t.addEventListener("click",(()=>{o&&(o=!1,c())})),t.dataset.clickListenerAdded="true")}));const e=document.querySelector(n)?.parentElement?.parentElement?.parentElement?.parentElement;if(!e)return;const a=e.children.length;let r;r=o?"40px "+"minmax(250px, 1fr) ".repeat(a-1):"minmax(250px, 1fr)".repeat(a),e.style.gridTemplateColumns=r;new Set(t.map((t=>t.parentElement)).filter(Boolean)).forEach((t=>{t.style.gridTemplateColumns=r}));const d=document.querySelector("#collapseBtn");d&&(d.classList.toggle("btnCollapsed",o),d.parentElement.firstChild.classList.toggle("hide",o))}function r(){if(document.querySelector("#collapseBtn"))return void c();const t=document.querySelector(a)?.parentElement;if(!t)return;const e=document.createElement("button");e.id="collapseBtn",e.className="horizontal-collapse-btn",e.title="Colapsar/Expandir",e.innerHTML='<svg class="icon-collapse" viewBox="0 0 24 24"><path d="M14 17.364l-6.73-5.364 6.73-5.364v10.728z" fill="currentColor"/></svg><svg class="icon-expand" viewBox="0 0 24 24"><path d="M10 17.364v-10.728l6.73 5.364-6.73 5.364z" fill="currentColor"/></svg>',t.style.display="flex",t.style.alignItems="center",t.appendChild(e),e.addEventListener("click",(t=>{t.stopPropagation(),t.preventDefault(),o=!o,c()})),c()}function d(){if(document.getElementById("custom-subtask-tooltip"))return;const t=document.createElement("div");t.id="custom-subtask-tooltip",document.body.appendChild(t),document.body.addEventListener("mouseover",(t=>{if(t.target.matches(".subtask-title-link")){const e=t.target;if(t.stopPropagation(),e.scrollWidth>e.clientWidth){const t=document.getElementById("custom-subtask-tooltip");t.textContent=e.dataset.fullTitle,t.style.display="block"}}}),!0),document.body.addEventListener("mouseout",(t=>{if(t.target.matches(".subtask-title-link")){t.stopPropagation();document.getElementById("custom-subtask-tooltip").style.display="none"}}),!0),document.body.addEventListener("mousemove",(t=>{const e=document.getElementById("custom-subtask-tooltip");"block"===e.style.display&&(e.style.left=t.pageX+10+"px",e.style.top=t.pageY+10+"px")}))}const u=p((()=>{e(),r(),d()}),100),m=new MutationObserver((()=>{u()}));function p(t,e){let n;return function(...a){clearTimeout(n),n=setTimeout((()=>{clearTimeout(n),t(...a)}),e)}}const f='div[data-testid="software-board.board-area"]',b=document.querySelector(f);b?m.observe(b,{childList:!0,subtree:!0}):m.observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("load",(()=>{setTimeout((()=>{e(),r(),d()}),2e3)}));